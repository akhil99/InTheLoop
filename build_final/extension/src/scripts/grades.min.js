chrome.extension.sendMessage({},function(t){var e=setInterval(function(){function t(t,e){return t.percent>e.percent?-1:t.percent<e.percent?1:0}function n(t){var e=t.target.id;$("#"+e).parent();$("#"+e+"t").blur(function(){$(this).attr("contentEditable",!1)}),$("#"+e+"t").attr("contentEditable",!0)}function i(t){return Number(t)}function r(t){var e=t.target.id,n=$("#"+e);a(n)}function a(t){var e=t.parent().contents().filter(function(){return 3==this.nodeType}).text().trim().replace("[","").replace("]","").trim(),n=p.map(function(t){return t.name}).indexOf(e),r=t.parent().parent().parent(),a=r.find("td:nth-child(4)",r).contents().filter(function(){return 3==this.nodeType}).text().replace(/\s/g,""),c=i(a.substring(a.indexOf("/")+1,a.indexOf("="))),a=i(a.substring(0,a.indexOf("/")));p[n].pointsN-=a,p[n].pointsD-=c,0==p[n].pointsD?(p[n].score="-",d(n,p[n].score)):(p[n].score=p[n].pointsN/p[n].pointsD,o(n,100*p[n].score,!0)),l(),t.parent().parent().parent().remove()}function d(t,e){$("h2:contains('Score') + div > table > tbody > tr:nth-child("+(t+2)+") td:nth-child(3)").text(e)}function o(t,e,n){if(n){var r=$("h2:contains('Score') + div > table > tbody > tr:nth-child("+(t+2)+") td:nth-child(3)"),a=r.text()+"";a=i(a.substring(0,a.indexOf("%"))),jQuery({val:a}).animate({val:e},{duration:500,easing:"swing",step:function(){r.text(this.val.toFixed(2)+"%")}})}else $("h2:contains('Score') + div > table > tbody > tr:nth-child("+(t+2)+") td:nth-child(3)").text(e+"%")}function c(t,e){for(var n=0;n<b.length;n++)if(t>=b[n].percent){$("b:nth-of-type(1)").text(""+b[n].letter);break}if(e){var r=$("b:nth-of-type(2)"),a=r.text()+"";f=t+"%",a=i(a.substring(0,a.indexOf("%"))),jQuery({val:a}).animate({val:t},{duration:500,easing:"swing",step:function(){r.text(this.val.toFixed(2)+"%")}})}else $("b:nth-of-type(2)").text(""+t+"%")}function s(t){$("b:nth-of-type(2)").text(""+t),$("b:nth-of-type(1)").text(t)}function l(){var t=0,e=0;if(u){for(var n=0,i=0,r=0;r<p.length;r++)"-"!=p[r].score&&(n+=p[r].pointsN,i+=p[r].pointsD);t=n/i*100,t=t.toFixed(2),c(t,!0)}else{for(var r=0;r<p.length;r++)"-"!=p[r].score&&(t+=p[r].score*p[r].percentage,e+=p[r].percentage);0==e?s("-"):0!=e&&(t=t/e*100,t=t.toFixed(2),c(t,!0))}}function h(){function t(){var t=$("#categoryDropdown")[0].selectedIndex,e=document.getElementById("aName").value,n=i(i(document.getElementById("aNum").value).toFixed(2)),r=i(i(document.getElementById("aDen").value).toFixed(1)),a=(Math.round(n/r*100*100)/100).toFixed(2),d=p[t].name;p[t].pointsN+=n,p[t].pointsD+=r,p[t].score=p[t].pointsN/p[t].pointsD;var c=i((Math.round(p[t].pointsN/p[t].pointsD*100*100)/100).toFixed(2));o(t,c,!0);var s=new Date,h=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear().toString().substring(2),f="highlight"!=$(".hub_general > .general_body > tr:nth-child(2)").attr("class")?"highlight":"";return l(),$newRow=$("<tr class='"+f+"'><td><div class='float_l padding_r5' style='min-width: 105px;'>"+d+"<br><a href='#'>"+e+'[<a href="javascript:void(0);" class = "deldel">X</a>] </a></div></td><td style=\'width:100%;\'></td><td>'+h+"<br></td><td nowrap=''><div>Score: "+n+"</div>"+n+" / "+r+" = "+a+"%</td><td class='list_text'><div style='width: 125px;'></div></td></tr>"),$("#inserted").after($newRow),!1}var e=!1;$("#myonoffswitch").is(":checked")&&(e=!0),$test=$('<tr id="inserted"><td align="center" class="inserted_two" colspan="1">Category: <select id="categoryDropdown"></select></td><td colspan="2" align="center" >Assignment:<input type="text" id="aName">&nbsp;<td style="vertical-align:middle;" colspan="2"><div style="float: left; ">Grade:<input type="number"    style="width:40px;" id="aNum">/<input     style="width:40px;" type="number" id="aDen"></div><a style="float:right;" id="add_grade" id="add_grade" href="#" style="float:right; padding-right:30px;">add grade</a></td></td></tr>').hide(),$test.show("slow"),$(".hub_general > .general_body > tr:first").before($test);for(var n=document.getElementById("categoryDropdown"),r=0;r<p.length;r++){var a=p[r].name,d=document.createElement("option");d.textContent=a,d.value=a,0==r&&(d.selected=!0),n.appendChild(d)}$("#add_grade").click(t)}if("complete"===document.readyState){clearInterval(e);var p=new Array,f=$("b:nth-of-type(2)").text()+"",u=!1,g=0;$('h2:contains("Score") + div > table > tbody > tr').each(function(t,e){if(0==t)$("td:nth-child(2)",e).text().indexOf("Score")>-1&&(g=$('h2:contains("Score") + div > table > tbody > tr').length-1,u=!0);else{var n,r,a,d,o;u?(n=$("td:nth-child(1)",e).text(),a=100/g/100,d=$("td:nth-child(2)",e).text().replace(/\s/g,""),o=i(d.substring(0,d.length-1))/100):(n=$("td:nth-child(1)",e).text(),r=$("td:nth-child(2)",e).text(),a=i(r.substring(0,r.length-1))/100,d=$("td:nth-child(3)",e).text().replace(/\s/g,""),o=i(d.substring(0,d.length-1))/100);var c={name:n,percentage:a,score:o,pointsN:0,pointsD:0};p.push(c)}});var v,x,y,b=[];$('h2:contains("Scale") + div * tr').each(function(t,e){$("td",e).each(function(){v=$(this).text(),x=v.substring(0,v.indexOf("=")).trim(),y=i(v.substring(v.indexOf("=")+1,v.indexOf("%")).trim());var t={letter:x,percent:y};b.push(t)})}),b.sort(t);var m=new Array;$(".hub_general > .general_body > tr").each(function(t,e){var n=$("td:nth-child(1) > div > a",e),r=n.text();n.after('[<a href="javascript:void(0);" class = "del" id = "del'+(t+1)+'">X</a>]');var a=$("td:nth-child(4)",e).contents().filter(function(){return 3==this.nodeType}).text().replace(/\s/g,"");if(!(a.indexOf("/")<0||a.indexOf("=")<0)){var d=i(a.substring(a.indexOf("/")+1,a.indexOf("="))),a=i(a.substring(0,a.indexOf("/"))),o=$("td:nth-child(1) > div",e).contents().filter(function(){return 3==this.nodeType}).text().trim().replace("[","").replace("]","").trim(),c=p.map(function(t){return t.name}).indexOf(o);if(c>=0){p[c].pointsN+=a,p[c].pointsD+=d;var s={name:r,pointValN:a,pointValD:d,categoryName:o,categoryIndex:c};m.push(s)}}}),$(".edit").click(n),$(".del").click(r),h(),$(document).on("click","a.deldel",function(t){var e=$(this);a(e)})}},10)});
